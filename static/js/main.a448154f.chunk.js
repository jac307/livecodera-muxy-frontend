(this["webpackJsonpmuxy-frontend"]=this["webpackJsonpmuxy-frontend"]||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},14:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(6),o=n.n(c),s=(n(12),n(2)),i=(n(13),n(14),n(0));var u=function(e){var t=e.eventUrl,n=e.startsAt,a=e.endsAt,c=Object(r.useState)(""),o=Object(s.a)(c,2),u=o[0],l=o[1],d=Object(r.useState)(""),j=Object(s.a)(d,2),m=j[0],b=j[1],h=Object(r.useState)(""),p=Object(s.a)(h,2),O=p[0],y=p[1],f=Object(r.useState)(""),v=Object(s.a)(f,2),x=v[0],g=v[1],S=Object(r.useState)(""),k=Object(s.a)(S,2),w=k[0],C=k[1];return Object(i.jsxs)(i.Fragment,{children:[x&&Object(i.jsxs)("div",{children:[Object(i.jsxs)("p",{children:["You have successfully registered for the event. Your streamkey is ",Object(i.jsx)("b",{children:x})," "]}),Object(i.jsx)("p",{children:"You should have received this as an email too. "}),Object(i.jsx)("p",{children:"Save this key well, you will need it for the event and also to delete your slot again. "}),Object(i.jsx)("p",{children:"When this page is reloaded, the key will no longer be displayed. "})]}),!x&&Object(i.jsxs)("form",{className:"PerformanceCreateForm",onSubmit:function(e){e.preventDefault(),fetch("".concat("https://muxy.tidalcycles.org/","/streams/"),{method:"post",headers:new Headers({Authorization:"Api-Key ".concat("m4UVRkuS.2hEqWjBdx1HNukpqXj0o8YSlew0ykkTR"),"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify({publisher_name:u,publisher_email:m,description:O,location:w,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,event:t,starts_at:n,ends_at:a})}).then((function(e){return e.json()})).then((function(e){g(e.key)})).catch(console.error)},children:[Object(i.jsx)("input",{id:"name",type:"text",placeholder:"Name",value:u,onChange:function(e){return l(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"email",type:"text",placeholder:"E-Mail",value:m,onChange:function(e){return b(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"description",type:"text",placeholder:"Description",value:O,onChange:function(e){return y(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"location",type:"text",placeholder:"Location",value:w,onChange:function(e){return C(e.target.value)},required:!0}),Object(i.jsx)("input",{type:"submit",className:"card-button",value:"Rave On"})]})]})};var l=function(e){var t=e.streamUrl,n=e.onRemove,a=Object(r.useState)(""),c=Object(s.a)(a,2),o=c[0],u=c[1],l=Object(r.useState)(!1),d=Object(s.a)(l,2),j=d[0],m=d[1];return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("form",{className:"PerformanceCreateForm",onSubmit:function(e){e.preventDefault(),m(!1);var r=new Headers({Authorization:"Api-Key ".concat("m4UVRkuS.2hEqWjBdx1HNukpqXj0o8YSlew0ykkTR"),"X-Stream-Key":o,"Content-Type":"application/json",Accept:"application/json"});fetch(t,{method:"DELETE",headers:r}).then((function(e){e.ok?(u(""),n&&n()):m(!0)})).catch((function(e){console.error(e),m(!0)}))},children:[Object(i.jsx)("p",{children:"Enter your streaming key to confirm you want to remove your slot. If you do not remember your streaming key, please contact the event organizer."}),j&&Object(i.jsx)("p",{style:{color:"red"},children:"Something went wrong, did you entered the incorrect stream key? Please try again."}),Object(i.jsx)("input",{id:"key",type:"text",placeholder:"Stream key",value:o,onChange:function(e){return u(e.target.value)},required:!0}),Object(i.jsx)("input",{type:"submit",className:"card-button",value:"Remove slot"})]})})},d=n(3),j=n(5);var m=function(e){var t=e.streamUrl,n=e.currMuxyStream,a=e.onSetInEditMode,c=e.setCurrMuxyStream,o=Object(r.useState)(n.publisher_name),u=Object(s.a)(o,2),l=u[0],d=u[1],m=Object(r.useState)(n.description),b=Object(s.a)(m,2),h=b[0],p=b[1],O=Object(r.useState)(""),y=Object(s.a)(O,2),f=y[0],v=y[1],x=Object(r.useState)(n.location),g=Object(s.a)(x,2),S=g[0],k=g[1],w=Object(r.useState)(!1),C=Object(s.a)(w,2),N=C[0],T=C[1];return Object(i.jsx)("div",{className:"PerformanceEditForm",children:Object(i.jsxs)("form",{className:"PerformanceCreateForm",onSubmit:function(e){e.preventDefault(),T(!1);var r=new Headers({Authorization:"Api-Key ".concat("m4UVRkuS.2hEqWjBdx1HNukpqXj0o8YSlew0ykkTR"),"X-Stream-Key":f,"Content-Type":"application/json",Accept:"application/json"}),o=JSON.stringify({publisher_name:l,description:h,location:S,ends_at:n.ends_at,starts_at:n.starts_at,event:n.event});fetch(t,{method:"PUT",headers:r,body:o}).then((function(e){e.ok?(v(""),a(!1),c(Object(j.a)(Object(j.a)({},n),{},{publisher_name:l,description:h,location:S}))):T(!0)})).catch((function(e){console.error(e),T(!0)}))},children:[Object(i.jsx)("p",{children:"Enter your streaming key to confirm you want to edit your slot. If you do not remember your streaming key, please contact the event organizer."}),N&&Object(i.jsx)("p",{style:{color:"red"},children:"Something went wrong, did you entered the incorrect stream key? Please try again."}),Object(i.jsx)("input",{id:"key",type:"text",placeholder:"Stream-Key",value:f,onChange:function(e){return v(e.target.value)},required:!0}),Object(i.jsx)("p",{children:"Here you find your stream information that you can edit. The email address can not displayed for security reasons. If you have problems with your e-mail adress, please contace the event organizer. The information will only be updated if you have entered the correct stream key."}),Object(i.jsx)("input",{id:"name",type:"text",placeholder:"Name",value:l,onChange:function(e){return d(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"description",type:"text",placeholder:"Description",value:h,onChange:function(e){return p(e.target.value)},required:!0}),Object(i.jsx)("input",{id:"location",type:"text",placeholder:"Location",value:S,onChange:function(e){return k(e.target.value)},required:!0}),Object(i.jsx)("input",{type:"submit",className:"card-button",value:"Save"})]})})},b=function(e){var t=e.muxyStream,n=e.cycleNo,a=e.eventUrl,c=Object(r.useState)(!1),o=Object(s.a)(c,2),j=o[0],b=o[1],h=Object(r.useState)(t),p=Object(s.a)(h,2),O=p[0],y=p[1],f=Object(r.useState)(!1),v=Object(s.a)(f,2),x=v[0],g=v[1],S=Object(r.useState)(!1),k=Object(s.a)(S,2),w=k[0],C=k[1],N=Object(r.useState)(!1),T=Object(s.a)(N,2),_=T[0],A=T[1],H=d.DateTime.fromISO(t.starts_at).toFormat("HH:mm LLL dd"),q=d.DateTime.fromISO(t.ends_at).toFormat("HH:mm LLL dd"),L=null;"publisher_name"in O&&(L=[O.publisher_name,O.location,O.description,O.timezone].join(" / "));var E=function(){b(!1),g(!1),C(!1)};return Object(i.jsx)("div",{className:"card",children:Object(i.jsxs)("div",{className:"card-body",children:[Object(i.jsxs)("p",{className:"card-header",children:["Cycle #",n]}),Object(i.jsxs)("p",{className:"card-time",children:[H,"-",q," ",!j&&!L&&Object(i.jsx)("button",{className:"card-button-plus",onClick:function(){return b(!0)},children:"+"})]}),_&&Object(i.jsx)("p",{children:"You have removed your slot succesfully."}),j?Object(i.jsx)(u,{eventUrl:a,startsAt:O.starts_at,endsAt:O.ends_at}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("p",{className:"card-text",children:_?"":L||""}),!_&&L&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("button",{onClick:function(){E(),C((function(e){return!e}))},className:"card-button",children:"Edit"}),Object(i.jsx)("button",{onClick:function(){E(),g((function(e){return!e}))},className:"card-button",children:"Remove"}),w&&"url"in O&&Object(i.jsx)(m,{streamUrl:O.url,currMuxyStream:O,onSetInEditMode:C,setCurrMuxyStream:y}),x&&"url"in O&&Object(i.jsx)(l,{streamUrl:O.url,onRemove:function(){return A(!0)}})]})]}),Object(i.jsx)("hr",{})]})})},h=function(e){var t=e.slug,n=e.eventUrl,a=e.startsAt,c=e.endsAt,o=e.setReservedStreamCount,u=e.setTotalStreamCount,l=Object(r.useState)(null),j=Object(s.a)(l,2),m=j[0],h=j[1];Object(r.useEffect)((function(){fetch("".concat("https://muxy.tidalcycles.org/","/streams/?event__slug=").concat(t),{method:"get",headers:new Headers({Authorization:"Api-Key ".concat("m4UVRkuS.2hEqWjBdx1HNukpqXj0o8YSlew0ykkTR")})}).then((function(e){return e.json()})).then((function(e){h(e)})).catch(console.error)}),[t]);var p=Object(r.useMemo)((function(){if(!a||!c)return[];if(!m)return[];var e=d.DateTime.fromISO(a),t=d.DateTime.fromISO(c).diff(e,["minute"]).toObject(),n=null!==t&&void 0!==t&&t.minutes?t.minutes/20:0,r=(null===m||void 0===m?void 0:m.results)||[];return Array.from(Array(n)).map((function(t,n){var a=e.plus({minutes:20*n}),c=a.plus({minutes:20}),o=a.toUTC().toFormat("yyyy-MM-dd'T'HH:mm:ss'Z'"),s=c.toUTC().toFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");return r.find((function(e){return e.starts_at==o&&e.ends_at==s}))||{starts_at:o,ends_at:s}}))}),[m]);return o(m?m.results.length:0),u(p?p.length:0),Object(i.jsx)("div",{className:"performance-list",children:p&&p.map((function(e,t){return Object(i.jsx)(b,{eventUrl:n,muxyStream:e,cycleNo:t+1},t)}))})},p=n.p+"static/media/longestnight-sunset-2.0.2ad7016e.svg",O=n(7),y=n.n(O);var f=function(e){var t=e.event,n=function(e,t){return null===e||null===t?{reserved:0,total:0,percent:0}:{reserved:e,total:t,percent:100*e/t}}(e.reservedStreamCount,e.totalStreamCount);return Object(i.jsxs)("header",{className:"App-header",children:[Object(i.jsx)("img",{src:p,className:"App-logo",alt:"logo"}),Object(i.jsx)("h4",{children:"Tidal Club Presents ..."}),Object(i.jsx)("h1",{children:"The Longest Night"}),Object(i.jsxs)("h2",{children:[" ",t&&d.DateTime.fromISO(t.starts_at).toFormat("dd. LLLL HH:mm")," - ",t&&d.DateTime.fromISO(t.ends_at).toFormat("dd. LLLL HH:mm")," ",t&&d.DateTime.fromISO(t.starts_at).toFormat("yyyy")]}),Object(i.jsx)("hr",{}),Object(i.jsx)(y.a,{className:"wrapper",bgColor:"#ffce96",baseBgColor:"#bbbbbb54",labelClassName:"label",labelAlignment:"outside",width:"100%",height:"28px",margin:"8px",customLabel:"".concat(n.reserved,"/").concat(n.total," slots are filled"),completed:n.percent}),Object(i.jsx)("hr",{}),Object(i.jsxs)("p",{children:["Your timezone: ",Intl.DateTimeFormat().resolvedOptions().timeZone]}),Object(i.jsx)("p",{className:"link-paragraph",children:Object(i.jsx)("a",{href:"https://www.youtube.com/eulerroom/live",children:"https://www.youtube.com/eulerroom/live"})}),Object(i.jsx)("p",{className:"link-paragraph",children:Object(i.jsx)("a",{href:"https://www.twitch.tv/eulerroom",children:"https://www.twitch.tv/eulerroom"})})]})};var v=function(){var e=Object(r.useState)(null),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),o=Object(s.a)(c,2),u=o[0],l=o[1],d=Object(r.useState)(null),j=Object(s.a)(d,2),m=j[0],b=j[1],p="livecodera";Object(r.useEffect)((function(){fetch("".concat("https://muxy.tidalcycles.org/","/events/?slug=").concat(p),{method:"get",headers:new Headers({Authorization:"Api-Key ".concat("m4UVRkuS.2hEqWjBdx1HNukpqXj0o8YSlew0ykkTR")})}).then((function(e){return e.json()})).then((function(e){a(e)})).catch(console.error)}),[p]);var O=null===n||void 0===n?void 0:n.results[0];return Object(i.jsxs)("main",{className:"App",children:[Object(i.jsx)(f,{event:O,reservedStreamCount:u,totalStreamCount:m}),O&&Object(i.jsx)(h,{slug:O.slug,eventUrl:O.url,startsAt:O.starts_at,endsAt:O.ends_at,setReservedStreamCount:l,setTotalStreamCount:b})]})};var x=function(){return Object(i.jsx)(v,{})};o.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(x,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.a448154f.chunk.js.map